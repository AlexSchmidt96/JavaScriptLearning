<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="dateAndTime.js"></script>
    <script src="calendar.js"></script>
    <title>Date and time</title>
    <style>
        table {
            border-collapse: collapse;
        }

        td,
        th {
            border: 1px solid black;
            padding: 3px;
            text-align: center;
        }

        th {
            font-weight: bold;
            background-color: #E6E6E6;
        }

        .tdColor {
            color: red;
        }

        .tdMonth {
            opacity: 50%;
        }
    </style>
</head>

<body>
    <div id='newCalendar'>
        <table>
            ...
        </table>
    </div>
    <script>
        // 1. Статические части календаря - должны быть сразу в верстке (изначально)
        // 2. Немного изменить алгоритм отрисовки: шагнуть до понедельника и начать рисовать строчки пока не нарисуем весь календарь

        function calendar(elem, year, month) {
            const now = new Date();
            const dateOptions = { month: 'long' }
            const monthIndex = month - 1;
            const date = new Date(year, monthIndex);
            const currMonth = date.toLocaleDateString('ru-RU', dateOptions);
            let tbody = ``

            const prevMonth = new Date(date);
            while (prevMonth.getDay() !== 1) {
                prevMonth.setDate(prevMonth.getDate() - 1)
                tbody = `<td class = "tdMonth">${prevMonth.getDate()}</td>` + tbody
            }

            while (date.getMonth() === monthIndex) {
                const isCurrentDay = date.getMonth() === now.getMonth() && date.getDate() === now.getDate();
                if (isCurrentDay) {
                    tbody += `<td class="tdColor">${date.getDate()}</td>`
                } else {
                    tbody += `<td>${date.getDate()}</td>`;
                }

                if (date.getDay() === 0) {
                    tbody += '</tr><tr>';
                }

                date.setDate(date.getDate() + 1);
            }

            while (date.getDay() !== 1) {
                tbody += `<td class = "tdMonth">${date.getDate()}</td>`
                date.setDate(date.getDate() + 1)
            }

            elem.innerHTML = `
                <table>
                    <caption> < ${currMonth} ${year} > </caption>
                    <thead>
                        <tr><th>пн</th><th>вт</th><th>ср</th><th>чт</th><th>пт</th><th>сб</th><th>вс</th></tr>
                    </thead>
                    <tbody>
                        <tr>${tbody}</tr>
                    </tbody>
                </table>
            `;
        }

        const calenderElement = document.getElementById('newCalendar')
        calendar(calenderElement, 2023, 4); 
    </script>
</body>

</html>